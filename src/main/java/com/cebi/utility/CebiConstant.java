package com.cebi.utility;

import javax.servlet.http.HttpServletRequest;

import org.apache.log4j.Logger;
import org.hibernate.Session;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import HibernateUtil.HibernateUtil;

import com.cebi.entity.Banks;
import com.cebi.service.AdminReportService;

@Repository
public class CebiConstant {
	private static final Logger logger = Logger.getLogger(CebiConstant.class);

	public static String ERROR = "error";

	@Autowired
	AdminReportService adminReportService;

	public static final String INVALID_USER = "Please provide valid Username and Password..!";
	public static final String GBCB_LOGO_IMAGE = "gbcb_logo.gif";
	public static final String BANK_LOGO_IMAGE = "ckgb_logo.jpg";
	public static final String CHGB_LOGO_IMAGE = "chgb_logo.jpg";
	public static final String SESSION_LOGOUT = "Please Login..!";
	public static final String CKGB = "CKGB";
	public static final String GBCB = "GBCB";
	public static final String APGV = "APGV";
	public static final String DCGB = "DCGB";
	public static final String SRGB = "SRGB";
	public static final String MRGB = "MRGB";
	public static final String MGRB = "MGRB";
	public static final String PUGB = "PUGB";
	public static final String UKGB = "UKGB";
	public static final String ACRB = "ACRB";
	public static final String LAGB = "LAGB";
	public static final String MLGB = "MLGB";
	public static final String MZGB = "MZGB";
	public static final String VCGB = "VCGB";
	public static final String SGPS = "SGPS";
	public static final String MBGB = "MBGB";
	public static final String UTGB = "UTGB";
	public static final String NGRB = "NGRB";
	public static final String ELGB = "ELGB";
	public static final String CHGB = "CHGB";
	public static final String SANB = "SANB";
	public static final String AHNB = "AHNB";
	public static final String GSNB = "GSNB";
	public static final String RJNB = "RJNB";

	public static final String BRNB = "BRNB";
	public static final String VANB = "VANB";
	public static final String JUNB = "JUNB";
	public static final String BDNB = "BDNB";
	public static final String ALNB = "ALNB";
	public static final String BANB = "BANB";
	public static final String TDCB = "TDCB";
	public static final String KHCB = "KHCB";
	public static final String SGBPS = "SGBP";
	public static final String BOM = "BOM";
	public static final String ARGB = "ARGB";
	public static final String PTGB = "PTGB";
	public static final String KVGB = "KVGB";
	public static final String BUCB = "BUCB";
	public static final String TGMC = "TGMC";
	public static final String PUCB = "PUCB";

	public static final String RIGHT = "                                                                                                                   ";
	public static final String NEW_LINE = "\n";
	public static final String EMPTY_SPACE = "  ";
	public static final String COMMA = " , ";
	public static final String PIPELINE = "| ";
	public static final String QRY_FROM = "FROM ";
	public static final String QRY_WHERE = " WHERE ";
	public static final String QRY_ROWNUM = " AND  ROWNUM < 100 ";
	public static final String WHERE_ROWNUM = " WHERE ROWNUM < 100 ";
	public static final String NO_RESULT = "No results found..!";
	public static final String IP_ADDRESS = "Permission denied for this ip";
	public static final String LOGIN = "login";
	public static final String LANDING = "landing";
	public static final String BANK_CODE = "bankCode";
	public static String BANKNAME = null;
	public static final String INLINE = "inline";
	public static String NAME_ALREADY_USED_ERR = "ORA-00955: name is already used by an existing object";
	public static String SERVICE_REQUESTED_CONNECT_ERR = "ORA-12514: TNS:listener does not currently know of service requested in connect descriptor";
	public static String Communication_Channel = "ORA-03150: end-of-file on communication channel for database link\n" + "ORA-02063: preceding line from MASTER_3_LINK\n" + "ORA-03150: end-of-file on communication channel for database link\n" + "ORA-02063: preceding line from MASTER_3_LINK";
	public static final String VIEW_DOESNOT_EXIST = "ORA-00942: table or view does not exist";

	public static final String CREATE_CUSTOMER_VIEW = "CREATE VIEW CUSTOMERS AS SELECT TO_NUMBER ( CUST_ACCT_NO || CHECKDIGIT.GENERATE (CUST_ACCT_NO) ) AS CUSTOMER_NUMBER, CUSTOMER_TYPE, CUSTOMER_STATUS, SEGMENT_CODE, TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + CREATE_DT, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) AS CREATE_DATE, HOME_BRANCH_NO, ATM_FLAG, CUST_TAX_PAN AS PAN_NUMBER, CUST_VOTER_ID AS VOTER_NUMBER, APPLY_TDS, TITLE_CODE, RPAD( RTRIM(B.NAME1, ' ') || ' ' || RTRIM(B.MID_NAME, ' ') || ' ' || RTRIM(B.NAME2, ' '), 30 ) AS CUST_NAME, FATHER_NAME, MOTHER_NAME, ADD1 AS ADDRESS_1, ADD2 AS ADDRESS_2, ADD3 AS ADDRESS_3, ADD4 AS ADDRESS_4, STATE_CODE, CITY_CODE, POSTCODE, PHONE_NO_RES AS PHONE_NUMBER_RESI, PHONE_NO_BUS AS PHONE_NUMBER_BUSINESS, FAX_NO, TELEX_NO, DOMESTIC_RISK, (SELECT ID_TYPE || ' - ' || ID_NUMBER FROM CUID WHERE INST_NO = '003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE = '0047') AS AADHAAR_SAME_ADD, (SELECT ID_TYPE || ' - ' || ID_NUMBER FROM CUID WHERE INST_NO = '003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE = '0048') AS AADHAAR_DIFF_ADD, (SELECT ID_TYPE || ' - ' || ID_NUMBER FROM CUID WHERE INST_NO = '003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE = '0007') AS ID_PAN, (SELECT ID_TYPE || ' - ' || ID_NUMBER FROM CUID WHERE INST_NO = '003' AND CUST_NO = A.CUST_ACCT_NO AND ID_MAIN = 'Y' AND ROWNUM < 2) AS PRIMARY_ID, (SELECT ID_TYPE || ' - ' || ID_NUMBER FROM CUID WHERE INST_NO = '003' AND CUST_NO = A.CUST_ACCT_NO AND ID_MAIN = 'N' AND ROWNUM < 2) AS SECOND_ID, (SELECT ABS(SUM(ID_POINT_VALUE)) FROM CUID C, IDTP I WHERE I.ID_TYPE = C.ID_TYPE AND I.INST_NO = '003' AND C.INST_NO = '003' AND CUST_NO = CUST_ACCT_NO) AS KYC_POINT, (SELECT /*+ INDEX (CUSVDD CUSVDDPK) */ TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + BIRTH_DATE_1, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) FROM cusvdd WHERE KEY_1 LIKE A.SOC_NO || A.CUST_ACCT_NO || '%') AS BIRTH_DATE, (SELECT /*+ INDEX (CUSVDD CUSVDDPK) */ DECODE( SEX_CODE, 'M', 'MALE', 'F', 'FEMALE', 'UNKN' ) FROM cusvdd WHERE KEY_1 LIKE A.SOC_NO || A.CUST_ACCT_NO || '%') AS GENDER, (SELECT /*+ INDEX (CUMI CUMIPK) */ TRIM(EMAIL_ADD1) FROM cumi WHERE INST_NO = A.SOC_NO AND CUST_NO = A.CUST_ACCT_NO) AS EMAIL FROM CUSM A, CUSVAA B WHERE A.SOC_NO = B.INST_NO AND A.CUST_ACCT_NO = B.CUST_NO AND A.ACCOUNT_SYSTEM = ' '";
	public static final String CREATE_CUSTOMER_VIEW_NB = "CREATE VIEW CUSTOMERS AS SELECT TO_NUMBER(CUST_ACCT_NO||CHECKDIGIT.GENERATE(CUST_ACCT_NO)) AS CUSTOMER_NUMBER, CUSTOMER_TYPE , CUSTOMER_STATUS , SEGMENT_CODE , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + CREATE_DT,'DD/MM/YYYY'), 'DD/MM/YYYY')AS CREATE_DATE , TO_NUMBER(HOME_BRANCH_NO) AS HOME_BRANCH_NO , ATM_FLAG , CUST_TAX_PAN AS PAN_NUMBER , CUST_VOTER_ID AS VOTER_NUMBER , APPLY_TDS , TITLE_CODE , RPAD(RTRIM(B.NAME1,' ')||' '||RTRIM(B.MID_NAME,' ')||' '||RTRIM(B.NAME2,' '),30) AS CUST_NAME , FATHER_NAME , MOTHER_NAME , ADD1 AS ADDRESS_1 , ADD2 AS ADDRESS_2 , ADD3 AS ADDRESS_3 , ADD4 AS ADDRESS_4 , STATE_CODE , CITY_CODE , POSTCODE , PHONE_NO_RES AS PHONE_NUMBER_RESI , PHONE_NO_BUS AS PHONE_NUMBER_BUSINESS , FAX_NO , TELEX_NO , DOMESTIC_RISK, (SELECT ID_TYPE ||' - '|| ID_NUMBER FROM CUID WHERE INST_NO ='003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE ='0061') AS AADHAAR_SAME_ADD, (SELECT ID_TYPE ||' - '|| ID_NUMBER FROM CUID WHERE INST_NO ='003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE ='0062') AS AADHAAR_DIFF_ADD, (SELECT ID_TYPE ||' - '|| ID_NUMBER FROM CUID WHERE INST_NO ='003' AND CUST_NO = A.CUST_ACCT_NO AND ID_TYPE ='0007') AS ID_PAN, (SELECT ID_TYPE ||' - '|| ID_NUMBER FROM CUID WHERE INST_NO ='003' AND CUST_NO = A.CUST_ACCT_NO AND ID_MAIN ='Y' AND ROWNUM < 2) AS PRIMARY_ID, (SELECT ID_TYPE ||' - '|| ID_NUMBER FROM CUID WHERE INST_NO ='003' AND CUST_NO = A.CUST_ACCT_NO AND ID_MAIN ='N' AND ROWNUM < 2) AS SECOND_ID, (SELECT ABS(SUM(ID_POINT_VALUE)) FROM CUID C,IDTP I WHERE I.ID_TYPE = C.ID_TYPE AND I.INST_NO = '003' AND C.INST_NO = '003' AND CUST_NO = CUST_ACCT_NO) AS KYC_POINT, (SELECT /*+ INDEX (CUSVDD CUSVDDPK) */ TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BIRTH_DATE_1,'DD/MM/YYYY'), 'DD/MM/YYYY') from cusvdd where KEY_1 like A.SOC_NO || A.CUST_ACCT_NO ||'%' ) AS BIRTH_DATE, (SELECT /*+ INDEX (CUSVDD CUSVDDPK) */ DECODE(SEX_CODE,'M','MALE','F','FEMALE','UNKN') from cusvdd where KEY_1 like A.SOC_NO || A.CUST_ACCT_NO ||'%' ) AS GENDER, (SELECT /*+ INDEX (CUMI CUMIPK) */ TRIM(EMAIL_ADD1) from cumi where INST_NO = A.SOC_NO and CUST_NO = A.CUST_ACCT_NO)AS EMAIL FROM CUSM A , CUSVAA B WHERE A.SOC_NO = B.INST_NO AND A.CUST_ACCT_NO = B.CUST_NO AND A.ACCOUNT_SYSTEM =' '";
	public static final String CREATE_GLINF_VIEW_NB = "CREATE VIEW GLINF AS SELECT KEY_1 , SOC , BRCH , FCY_CODE , GL_CLASS_CODE , DESCRIPTION , POSTING_IND , tO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + TRANS_DATE,'DD/MM/YYYY'), 'DD/MM/YYYY') TRANS_DATE , LCY_AMT , FCY_AMT , REVERSAL_CODE , GLIF_REFERENCES , SOURCE_APPLN , PS_JOURNAL_ID , PS_JOURNAL_NBR from GL01 WHERE substr(key_1,5,5) > TO_CHAR(TO_DATE(ADD_MONTHS(SYSDATE,-3),'DD-MON-YY'),'J')-2415020";

	public static final String CREATE_BGLTRNS_VIEW = "CREATE VIEW BGLTRNS AS SELECT /*+ PARALLEL(G,64) */ to_number(SUBSTR (acct_no, 1, 11)) as BGL_NO, TO_NUMBER(ACCT_NO||CHECKDIGIT.GENERATE(ACCT_NO)) AS ACCOUNT_NUMBER, G.JRNL_NO AS JOURNAL_NUMBER, TRAN_TYPE AS TRANSACTION_TYPE, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + POST_DATE,'DD/MM/YYYY'), 'DD/MM/YYYY') POSTING_DATE , BASECONV.CONVDATA(VAR_AREA,19,4) AS TRANSACTION_NUMBER, (CASE WHEN BASECONV.CONVDATA(VAR_AREA,31,8,3) < 0 THEN BASECONV.CONVDATA(VAR_AREA,31,8,3) ELSE 0 END) DR_AMOUNT, (CASE WHEN BASECONV.CONVDATA(VAR_AREA,31,8,3) > 0 THEN BASECONV.CONVDATA(VAR_AREA,31,8,3)*-1 ELSE 0 END) CR_AMOUNT , to_number(SUBSTR (acct_no, 12, 5))AS BRANCH_CD , BASECONV.CONVDATA(VAR_AREA,9,4) AS BRCH_TRNS, BASECONV.CONVDATA(VAR_AREA,15,4)AS TELLER, (SELECT /*+ PARALLEL(G1,64) */ DISTINCT RPAD(DECODE(TRAN_TYPE,20,SUBSTR(VAR_AREA,13,49),1,(SELECT RPAD(TRIM(' ' FROM TEXT),20,' ') FROM TXOP WHERE KEY_1 = '003'||LPAD(BASECONV.CONVDATA(VAR_AREA,17,4),6,'0')||'TCSH01'),' '),49,' ') FROM GECT G1 WHERE G1.INST_NO = '003' AND G1.ACCT_NO = G.ACCT_NO AND G1.JRNL_NO = G.JRNL_NO AND G1.TRAN_TYPE = '20' AND ROWNUM <=1) NARRATION FROM GECT G WHERE G.INST_NO = '003' AND TRAN_TYPE = 1 AND TRAN_DATE BETWEEN 43100 AND 43464 ";
	public static final String CREATE_DEMAND_DEPOSIT_VIEW = "CREATE OR REPLACE VIEW DEMAND_DEPOSIT AS SELECT TO_NUMBER(BRANCH_NO) AS BRANCH_NO, TO_NUMBER(CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO)) AS CUSTOMER_NUMBER, TO_NUMBER(SUBSTR(KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(KEY_1,4,16))) AS ACCOUNT_NUMBER, to_number(ACCT_TYPE) AS ACCOUNT_TYPE, to_number(a.INT_CAT) AS INTEREST_CATEGORY, LPAD(B.DESCRIPT,30,' ') as PRODUCT_CODE , ACCT_STMT_CODE AS SEGMENT_CODE, GL_CLASS_CODE, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ACCT_OPEN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS OPEN_DATE , to_number(CURR_BAL) AS CURR_BAL, CR_STORE_RATE, CASE WHEN a.CURR_BAL < 0 THEN BASECONV.CONVDATA(OD_VISA_AREA,200,8)/100000 ELSE (INT_AVAILABLE+INT_ADJUSTMENT) END AS INT_AVAILABLE, CASE WHEN a.CURR_BAL < 0 THEN BASECONV.CONVDATA(OD_VISA_AREA,208,8)/100000 ELSE INT_INCR END AS INT_INCR, DECODE(CURR_STATUS,'00','OPN', '07', 'CLS', '03', 'INOP','01','DORM','02','UNCL','11','INCT','UNKN') AS STAT , UNCL_CHQ_VAL, SI_HOLD_AMT, RESERVED_AMOUNT, SWEEP_BALANCE, INT_PROJ, HOLD_VAL, NO_OF_HOLDS, CASE WHEN HOLD_DT > 0 THEN TO_CHAR(TO_DATE((2415020 + HOLD_DT), 'J'),'DDMMYYYY') ELSE ' ' END AS HOLD_DATE , MINOR_AC, DEATH_FLAG, NO_OF_STOPS, CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_FINANCIAL_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_CR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_CREDIT_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_DR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_DEBIT_DATE , CASE WHEN (LST_FIN_DT > 0 AND CURR_STATUS ='07') THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS CLOSE_DATE , INT_ADJUSTMENT, (SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO = CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO =CUSTOMER_NO)) AS CUST_NAME FROM INVM a, DEPP B WHERE SUBSTR(ACCT_TYPE,1,1) IN ('1','3','5') AND ACCT_TYPE = B.TYPE AND A.INT_CAT = B.INT_CAT";
	public static final String CREATE_TIME_DEPOSIT_VIEW = "CREATE VIEW TIME_DEPOSIT AS SELECT TO_NUMBER(BRANCH_NO) AS BRANCH_NO , TO_NUMBER(CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO)) AS CUSTOMER_NUMBER, TO_NUMBER(SUBSTR(KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(KEY_1,4,16))) AS ACCOUNT_NUMBER, to_number(ACCT_TYPE) AS ACCOUNT_TYPE, to_number(A.INT_CAT) AS INTEREST_CATEGORY, LPAD(B.DESCRIPT,30,' ') as PRODUCT_CODE , ACCT_STMT_CODE AS SEGMENT_CODE, GL_CLASS_CODE, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ACCT_OPEN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS OPEN_DATE , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + OPEN_POST_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS OPEN_POST_DT , LPAD(TRAP,4,' ') AS TRAP, TRF_ACCT_NO, to_number(CURR_BAL) AS CURR_BAL, to_number(CURR_BAL) AS PRINCIPAL, TO_CHAR(VAR_INT_RATE,'99.99') AS INT_RATE, to_number(INT_AVAILABLE) AS INT_AVAILABLE, to_number(TERM_INT_COMP_AMT) AS TRM_INT_CMP, TO_CHAR(INT_INCR,'999999999999.99') AS INT_INCR, LPAD(A.TERM_PAY_FREQUENCY,8,' ') AS PAY_FREQ, LPAD(A.TERM_INT_COMP_FREQ,8,' ') AS CMP_FREQ, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + TRM_INT_CMP_SOP_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS TRM_INT_CMP_SOP_DT , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + TRM_INT_CMP_EOP_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS TRM_INT_CMP_EOP_DT , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BASECONV.CONVDATA(OD_VISA_AREA, 19,4),'DD/MM/YYYY'),'DD/MM/YYYY') AS MATURITY_DATE , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + INT_FRM_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS INTEREST_FROM , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + INT_TO_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS INTEREST_TO , TO_CHAR(BASECONV.CONVDATA(OD_VISA_AREA, 53,8)/1000,'999999999999.99') AS MATURITY_VALUE , RPAD(NVL(BASECONV.CONVDATA(OD_VISA_AREA, 51,2),0),2,' ')||' '||RPAD(NVL(BASECONV.CONVDATA(OD_VISA_AREA, 49,2),0),3,' ')||' '||RPAD(NVL(BASECONV.CONVDATA(OD_VISA_AREA, 27,4),0),4,' ') AS TERM_LENGTH, BASECONV.CONVDATA(OD_VISA_AREA, 27,4) AS TRM_DAY , TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA, 31,8)) AS TERM_VALUE , BASECONV.CONVDATA(OD_VISA_AREA, 47,2) AS TRM_NO_DAYS , BASECONV.CONVDATA(OD_VISA_AREA, 49,2) AS TRM_NO_MONTHS , BASECONV.CONVDATA(OD_VISA_AREA, 51,2) AS TRM_NO_YEARS , BASECONV.CONVDATA(OD_VISA_AREA, 53,8,3) AS TRM_MAT_VAL , SUBSTR(OD_VISA_AREA,124,2) AS TERM_NO_INSTL_CNT , TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA, 134,8)) AS TERM_INSTL_AMT , BASECONV.CONVDATA(OD_VISA_AREA, 146,8) AS NEW_INSTL_AMT , DECODE(CURR_STATUS,'00','OP', '07', 'CL', '03', 'IN','01','DO','02','UC','UN') AS STAT , UNCL_CHQ_VAL, SI_HOLD_AMT, RESERVED_AMOUNT, SWEEP_BALANCE, INT_PROJ, HOLD_VAL, NO_OF_HOLDS, CASE WHEN HOLD_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + HOLD_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS HOLD_DATE , MINOR_AC, DEATH_FLAG, NO_OF_STOPS, CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_FINANCIAL_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_CR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_CREDIT_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_DR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_DEBIT_DATE , CASE WHEN (LST_FIN_DT > 0 AND CURR_STATUS ='07') THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS CLOSE_DATE , INT_ADJUSTMENT, (SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO = CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO =CUSTOMER_NO)) AS CUST_NAME FROM INVM A , DEPP B WHERE SUBSTR(ACCT_TYPE,1,1) = '2' AND ACCT_TYPE = B.TYPE AND A.INT_CAT = B.INT_CAT";
	public static final String CREATE_CASHCREDIT_OVERDRAFT_VIEW = "CREATE VIEW CASHCREDIT_OVERDRAFT AS SELECT TO_NUMBER(BRANCH_NO) AS BRANCH_NO , TO_NUMBER(CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO)) AS CUSTOMER_NUMBER, TO_NUMBER(SUBSTR(I.KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(I.KEY_1,4,16))) AS ACCOUNT_NUMBER, to_number(ACCT_TYPE) AS ACCOUNT_TYPE, to_number(I.INT_CAT) AS INTEREST_CATEGORY, LPAD(B.DESCRIPT,30,' ') as PRODUCT_CODE , ACCT_STMT_CODE AS SEGMENT_CODE, I.GL_CLASS_CODE, TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA,99,4)/100000) AS INT_RATE, BASECONV.CONVDATA(OD_VISA_AREA,94,2) AS LIMIT_TYPE, TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA,200,8)/100000) AS INTEREST_AVAILABLE, TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA,208,8)/100000) AS INTEREST_INCR, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ACCT_OPEN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') AS OPEN_DATE , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BASECONV.CONVDATA(OD_VISA_AREA,1,4),'DD/MM/YYYY'),'DD/MM/YYYY') AS EFFCTVE_DT , TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BASECONV.CONVDATA(OD_VISA_AREA,5,4),'DD/MM/YYYY'),'DD/MM/YYYY') AS EXPIRY_DT, BASECONV.CONVDATA(OD_VISA_AREA,233,4)/100000 AS EXPIRY_RATE, substr(od_visa_area,150,1) as XS_RATE_TYPE, baseconv.convdata(od_visa_area,151,4) as XS_RATE, substr(od_visa_area,98,1) as LIM_RATE_TYPE1, to_number(CURR_BAL) AS CURR_BAL, to_number(BASECONV.CONVDATA(OD_VISA_AREA,103,8)) AS LIMIT_AMOUNT, to_number(I.DRAWING_AMOUNT) AS DRAWING_POWER, DECODE(CURR_STATUS,'00','OP', '07', 'CL', '03', 'IN','01','DO','02','UC','UN') AS STAT , NEW_BAD_DEBT_IND, OLD_BAD_DEBT_IND, UNCL_CHQ_VAL AS UNCLEAR_CHEQUE_AMOUNT, SI_HOLD_AMT AS SI_HOLD_AMOUNT , RESERVED_AMOUNT, SWEEP_BALANCE, HOLD_VAL AS HOLD_AMOUNT, NO_OF_HOLDS, CASE WHEN HOLD_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + HOLD_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS HOLD_DT , MINOR_AC, DEATH_FLAG, NO_OF_STOPS, CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_FINANCIAL_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_CR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_CREDIT_DATE , CASE WHEN LST_FIN_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_CUST_DR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_CUSTOMER_DEBIT_DATE , CASE WHEN (LST_FIN_DT > 0 AND CURR_STATUS ='07') THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LST_FIN_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS CLOSE_DATE , DR_INT_ADJUSTMENT AS DEBIT_INTEREST_ADJUSTMENT, CR_STORE_RATE, CR_TIER_GRP_ID, BKDT_INT_ADJ_IND, UNPD_OD_DR_INT, UNPD_OD_PNLTY_INT, OD_PNLTY_INT_ACCR, OD_PNLTY_INT_INCR, CASE WHEN LAST_UNDR_SECUR_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LAST_UNDR_SECUR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_UNDER_SECURITY_DATE , CASE WHEN LAST_OVER_SECUR_DT > 0 THEN TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + LAST_OVER_SECUR_DT,'DD/MM/YYYY'),'DD/MM/YYYY') END AS LAST_OVER_SECURITY_DATE , C.INCA AS INCA_AMOUNT , UNPD_OD_DR_INT_PY AS UIPY, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + NPA_DATE,'DD/MM/YYYY'),'DD/MM/YYYY') AS NPA_DATE, LENDING_STATUS, (SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO =CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO =CUSTOMER_NO)) AS CUST_NAME , OD_INT_TAX_YTD , OD_INT_TAX_YTD_PY FROM INVM I , INCC C , DEPP B WHERE I.KEY_1 = C.KEY_1 AND ACCT_TYPE = B.TYPE AND I.INT_CAT = B.INT_CAT AND ACCT_TYPE LIKE '6%'";
	public static final String CREATE_LOANS_VIEW = "CREATE VIEW LOANS AS SELECT TO_NUMBER(BR_NO) AS BRANCH_NO, TO_NUMBER(CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO)) AS CUSTOMER_NUMBER, TO_NUMBER(SUBSTR(BORM.KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(BORM.KEY_1,4,16))) AS ACCOUNT_NUMBER, to_number(ACT_TYPE) ACCT_TYPE , to_number(CAT) INT_CAT , LPAD(B.CAT_TYPE_NAME,30,' ') as PRODUCT_CODE , MARKET_SEG_CODE AS SEG_CODE, GL_CLASS_CODE, DECODE(INT_REST,'01','MONTHLY','03','QUARTERLY','06','HALF-YEARLY','12','YEARLY','99','DAILY') AS CAPITAL_FREQ, CASE WHEN INT_STRT_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + INT_STRT_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS INT_STRT_DATE, CASE WHEN APPLIC_ISSUE_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + APPLIC_ISSUE_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS APPLIC_ISSUE_DATE, CASE WHEN APPRV_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + APPRV_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS APPRV_DATE, CASE WHEN LST_ARR_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + LST_ARR_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS LST_ARR_DATE, CASE WHEN LAST_INT_ARR_DT > 0 THEN TO_CHAR(TO_DATE((2415020 + LAST_INT_ARR_DT), 'J'),'DDMMYYYY') ELSE ' ' END AS LAST_INT_ARR_DT, to_number(APP_AMT + ADD_LOAN_APP) APPRV_AMT , to_number(ADV_VAL) AS DISBRS_AMT, STAT , to_number(LOAN_BAL) AS LOAN_BAL, LPAD(STORE_RATE,7) AS INTRATE, UNPD_PRIN_BAL , CAP_UNPD_INT , UNPD_CHRG_BAL , UNPD_ARRS_INT_BAL , INT_INCR , BPI_ACCR , BPI_INCR , ARR_INT_ACCR , ARR_INT_INCR , ARR_ACCR_AMT , THEO_LOAN_BAL , THEO_UNPD_PRIN_BAL , CAP_THEO_UNPD_INT , THEO_UNPD_CHRG_BAL , THEO_UNPD_ARRS_INT, DRAWING_AMOUNT, SECURITY_AMOUNT, PROVISION_AMOUNT, CASE WHEN DUE_STRT_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + DUE_STRT_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS DUE_START_DATE, TO_CHAR(LPAD(REM_REPAYS,9)) AS REM_REPAY, RPAD(DECODE(REPAY_OPTION,' ',NULL, DECODE((TO_NUMBER(REPAY_OPTION)-00),0,'NA', DECODE((TO_NUMBER(REPAY_OPTION)-01),0,'EMI', DECODE((TO_NUMBER(REPAY_OPTION)-02),0,'PED', DECODE((TO_NUMBER(REPAY_OPTION)-04),0,'NEG', NULL ))))) ,5) REPAY , DUE_AMT AS INSTALLMENT, BAD_DEBT_IND, OLD_BAD_DEBT_IND, CASE WHEN NPA_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + NPA_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS NPA_DATE, INCA AS INCA_AMOUNT, BORM.REPAY_DAY, DECODE(BORM.REPAY_FREQ,'01','MONTHLY','03','QUARTERLY','06','HALF-YEARLY','12','YEARLY','99','DAILY') AS REPAY_FREQ, INTEREST, LOAN_REPAY, CASE WHEN LST_FIN_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + LST_FIN_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS LST_FIN_DATE, CASE WHEN LAST_CREDIT_DT > 0 THEN TO_CHAR(TO_DATE((2415020 + LAST_CREDIT_DT), 'J'),'DDMMYYYY') ELSE ' ' END AS LAST_CREDIT_DT, CASE WHEN LST_MNT_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + LST_MNT_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS LST_MNT_DATE, REASON_ARR_CDE, SECURITY_IND, TERM_BASIS, RT_INCR AS RATE_INCRMENTAL, APPLIC_AMOUNT AS APPLICATION_AMOUNT, CASE WHEN PEND_DUES_DATE > 0 THEN TO_CHAR(TO_DATE((2415020 + PEND_DUES_DATE), 'J'),'DDMMYYYY') ELSE ' ' END AS VPREVIOUS_INST_DATE, ADD_MONTHS( CASE WHEN PEND_DUES_DATE > = 0 THEN TO_CHAR(TO_DATE((2415020 + PEND_DUES_DATE), 'J'),'DD/MON/YYYY') ELSE '0' END, 1) AS NEXT_INST_DATE , (SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO = CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO = CUSTOMER_NO)) AS CUST_NAME , INT_TAX_YTD , INT_TAX_YTD_PY , CAP_UNPD_INT_PY as UIPY, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ADV_DATE,'DD/MM/YYYY'),'DD/MM/YYYY') AS ADV_DATE FROM BORM, BORG , LONP B WHERE BORM.KEY_1 = BORG.KEY_1 AND ACT_TYPE = B.ACCT_TYPE AND CAT = B.INT_CAT ";
	public static final String CREATE_NPA_CUSTOMERS_VIEW = "CREATE OR REPLACE VIEW NPA_CUSTOMERS AS SELECT /*+ PARALLEL */ DISTINCT customer_no, 'LON' AS TYPE FROM borm b WHERE key_1 LIKE '003%' AND STAT <> '40' AND OLD_BAD_DEBT_IND >= '04' UNION ALL SELECT /*+ PARALLEL */ DISTINCT customer_no, 'INV' AS TYPE FROM INVM b WHERE key_1 LIKE '003%' AND CURR_STATUS <>'07' AND OLD_BAD_DEBT_IND >= '04' ";
	public static final String CREATE_ONE_NPA_ALL_VIEW = "CREATE VIEW ONE_NPA_ALL  AS SELECT /*+ PARALLEL */ TO_NUMBER(BR_NO) AS BRANCH_NO,TO_NUMBER(BORM.CUSTOMER_NO||CHECKDIGIT.GENERATE(BORM.CUSTOMER_NO)) AS CUSTOMER_NUMBER,TO_NUMBER(SUBSTR(BORM.KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(BORM.KEY_1,4,16))) AS ACCOUNT_NUMBER,TO_NUMBER(ACT_TYPE) ACCT_TYPE ,TO_NUMBER(CAT)  INT_CAT ,	LPAD(B.CAT_TYPE_NAME,30,' ') AS PRODUCT_CODE ,	MARKET_SEG_CODE AS SEG_CODE,	GL_CLASS_CODE,STORE_RATE AS INTRATE,	TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + APPRV_DATE,'DD/MM/YYYY')AS APPRV_DATE  ,	TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + APPRV_DATE,'DD/MM/YYYY')AS EFFCTVE_DT  ,'0' AS EXPIRY_DT,TO_NUMBER(LOAN_BAL) AS LOAN_BAL,TO_NUMBER(APP_AMT + ADD_LOAN_APP) APPRV_AMT ,STAT,DECODE(BAD_DEBT_IND,00, 'STANDARD ASSET',01, 'STANDARD BUT IRREGULAR FOR 7 DAYS',02, 'STANDARD BUT IRREGULAR FOR OVER 30 DAYS',03, 'STANDARD BUT IRREGULAR FOR OVER 60 DAYS',04, 'SUB-STANDARD ASSET ',05, 'DOUBTFUL ASSET – LESS THAN 1 YEAR',06, 'DOUBTFUL ASSET  = > 1 YEAR BUT < 3 YEARS ',07, 'DOUBTFUL ASSET  = > 3 YEARS',08, 'LOSS ASSET','STANDARD') AS BAD_DEBT_IND,DECODE(OLD_BAD_DEBT_IND,00, 'STANDARD ASSET',01, 'STANDARD BUT IRREGULAR FOR 7 DAYS',02, 'STANDARD BUT IRREGULAR FOR OVER 30 DAYS',03, 'STANDARD BUT IRREGULAR FOR OVER 60 DAYS',04, 'SUB-STANDARD ASSET ',05, 'DOUBTFUL ASSET – LESS THAN 1 YEAR',06, 'DOUBTFUL ASSET  = > 1 YEAR BUT < 3 YEARS ',07, 'DOUBTFUL ASSET  = > 3 YEARS',08, 'LOSS ASSET','STANDARD') AS OLD_BAD_DEBT_IND ,	INCA  AS INCA_AMOUNT,	CAP_UNPD_INT_PY AS UIPY,TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + NPA_DATE,'DD/MM/YYYY')AS NPA_DATE  ,(SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO = BORM.CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND  CUST_NO = BORM.CUSTOMER_NO)) AS CUST_NAME ,INT_TAX_YTD ,INT_TAX_YTD_PY  FROM  BORM, BORG , LONP B , NPA_CUSTOMERS C WHERE BORM.KEY_1 = BORG.KEY_1   AND ACT_TYPE = B.ACCT_TYPE AND CAT = B.INT_CAT   AND STAT <> '40' AND BORM.CUSTOMER_NO = C.CUSTOMER_NO  UNION ALL	SELECT /*+ PARALLEL */ TO_NUMBER(BRANCH_NO) AS BRANCH_NO ,TO_NUMBER(I.CUSTOMER_NO||CHECKDIGIT.GENERATE(I.CUSTOMER_NO)) AS CUSTOMER_NUMBER, TO_NUMBER(SUBSTR(I.KEY_1,4,16)||CHECKDIGIT.GENERATE( SUBSTR(I.KEY_1,4,16))) AS ACCOUNT_NUMBER, TO_NUMBER(ACCT_TYPE)  AS ACCOUNT_TYPE, TO_NUMBER(I.INT_CAT)  AS INTEREST_CATEGORY, LPAD(B.DESCRIPT,30,' ') AS PRODUCT_CODE ,	ACCT_STMT_CODE AS SEGMENT_CODE,	I.GL_CLASS_CODE, TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA,99,4)/100000) AS INT_RATE, TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ACCT_OPEN_DT,'DD/MM/YYYY')AS ACCT_OPEN_DT  , TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BASECONV.CONVDATA(OD_VISA_AREA,1,4),'DD/MM/YYYY')AS EFFCTVE_DT  , TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + BASECONV.CONVDATA(OD_VISA_AREA,5,4),'DD/MM/YYYY')AS EXPIRY_DT  ,TO_NUMBER(CURR_BAL)  AS CURR_BAL, TO_NUMBER(BASECONV.CONVDATA(OD_VISA_AREA,103,8)) AS LIMIT_AMOUNT, DECODE(CURR_STATUS,'00','OP', '07', 'CL', '03', 'IN','01','DO','02','UC','UN') AS STAT , DECODE(NEW_BAD_DEBT_IND,00, 'STANDARD ASSET',01, 'STANDARD BUT IRREGULAR FOR 7 DAYS',02, 'STANDARD BUT IRREGULAR FOR OVER 30 DAYS',03, 'STANDARD BUT IRREGULAR FOR OVER 60 DAYS',04, 'SUB-STANDARD ASSET ',05, 'DOUBTFUL ASSET – LESS THAN 1 YEAR',06, 'DOUBTFUL ASSET  = > 1 YEAR BUT < 3 YEARS ',07, 'DOUBTFUL ASSET  = > 3 YEARS',08, 'LOSS ASSET','STANDARD') AS NEW_BAD_DEBT_IND , DECODE(OLD_BAD_DEBT_IND,00, 'STANDARD ASSET',01, 'STANDARD BUT IRREGULAR FOR 7 DAYS',02, 'STANDARD BUT IRREGULAR FOR OVER 30 DAYS',03, 'STANDARD BUT IRREGULAR FOR OVER 60 DAYS',04, 'SUB-STANDARD ASSET ',05, 'DOUBTFUL ASSET – LESS THAN 1 YEAR',06, 'DOUBTFUL ASSET  = > 1 YEAR BUT < 3 YEARS ',07, 'DOUBTFUL ASSET  = > 3 YEARS',08, 'LOSS ASSET','STANDARD') AS OLD_BAD_DEBT_IND , C.INCA AS INCA_AMOUNT , UNPD_OD_DR_INT_PY AS UIPY, TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + NPA_DATE,'DD/MM/YYYY')AS NPA_DATE  , (SELECT (RPAD(TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2),55,' ')) FROM CUSVAA WHERE INST_NO ='003' AND CUST_NO =I.CUSTOMER_NO AND RECNO = (SELECT MAX(RECNO) FROM CUSVAA WHERE INST_NO ='003' AND  CUST_NO =I.CUSTOMER_NO)) AS CUST_NAME ,	OD_INT_TAX_YTD , OD_INT_TAX_YTD_PY  FROM INVM I , INCC C , DEPP B , NPA_CUSTOMERS D WHERE I.KEY_1 = C.KEY_1 AND ACCT_TYPE = B.TYPE AND I.INT_CAT = B.INT_CAT  AND CURR_STATUS <>'07' AND ACCT_TYPE LIKE '6%' AND I.CUSTOMER_NO = D.CUSTOMER_NO ";
	public static final String CREATE_ATM_VIEW = "CREATE VIEW ATMCARD AS SELECT BRANCH_NO, SUBSTR(I.KEY_1||CHECKDIGIT.GENERATE(SUBSTR(I.KEY_1,4,16)),4,17) AS ACCT_NO, CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO) AS CUST_NO, SUBSTR((SELECT TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2) FROM CUSVAA WHERE CUSVAA.INST_NO = '003' AND CUSVAA.CUST_NO = CUSTOMER_NO AND EFFE_DATE = 0),1,30) AS NAME, EMBOSS_NAME, ACCT_TYPE, CARD_TYPE, I.INT_CAT,CARD_NUMBER, CASE WHEN CARD_NUMBER = ' ' THEN ' ' ELSE 'XXXXXXXXXXXX'||TRIM(SUBSTR(CARD_NUMBER,19,4)) END AS ATM_CARD_NO, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + DATE_OF_APPL,'DD/MM/YYYY'), 'DD/MM/YYYY')AS DATE_OF_APPL , CARD_STATUS, MAKER_ID, CHECKER_ID FROM INVM I , GCAP WHERE KEY_1 like '003%' AND SUBSTR(KEY_1,4,16) = SUBSTR(PRI_ACCT_NO,1,16)";
	public static final String CREATE_LOC_MAS_VIEW = "CREATE VIEW LOCKER_MASTER AS SELECT m.BRANCH_NO, m.CUSTOMER_NO||CHECKDIGIT.GENERATE(m.CUSTOMER_NO) AS CUST_NO, m.ACCOUNT_NO||CHECKDIGIT.GENERATE(m.ACCOUNT_NO) AS ACCT_NO, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + NEXT_MT_FEE_DUE_DT,'DD/MM/YYYY'), 'DD/MM/YYYY')AS NEXT_MT_FEE_DUE_DT , MAINT_FEE_TOTAL Fees_in_arr, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + ACCT_OPEN_DATE,'DD/MM/YYYY'), 'DD/MM/YYYY')AS ACCT_OPEN_DATE , MAINT_FEE_COLLECT, ACCT_STATUS, LOCKER_STATUS, m.FEE_BEAR_ACCT||CHECKDIGIT.GENERATE(m.FEE_BEAR_ACCT) AS FEE_BEAR_ACCT, trim(NAME1)||' '||trim(mid_name)||' '||trim(NAME2) name from sdvm m, sdlm s , cusvaa c where m.INST_NO = c.INST_NO and m.INST_NO = s.INST_NO and m.CUSTOMER_NO = c.CUST_NO and m.ACCOUNT_NO = s.ACCOUNT_NO and LOCKER_STATUS = '01' and MAINT_FEE_TOTAL <> '0'";

	public static final String CREATE_ATMCARD_VIEW = "CREATE VIEW ATMCARD AS SELECT BRANCH_NO, SUBSTR(I.KEY_1||CHECKDIGIT.GENERATE(SUBSTR(I.KEY_1,4,16)),4,17) AS ACCT_NO, CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO) AS CUST_NO, SUBSTR((SELECT TRIM(NAME1)||' '||TRIM(MID_NAME)||' '||TRIM(NAME2) FROM CUSVAA WHERE CUSVAA.INST_NO = '003' AND CUSVAA.CUST_NO = CUSTOMER_NO AND EFFE_DATE = 0),1,30) AS NAME, EMBOSS_NAME, ACCT_TYPE, CARD_TYPE, I.INT_CAT,CARD_NUMBER, CASE WHEN CARD_NUMBER = ' ' THEN ' ' ELSE 'XXXXXXXXXXXX'||TRIM(SUBSTR(CARD_NUMBER,19,4)) END AS ATM_CARD_NO, TO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + DATE_OF_APPL,'DD/MM/YYYY'), 'DD/MM/YYYY')AS DATE_OF_APPL , CARD_STATUS, MAKER_ID, CHECKER_ID FROM INVM I , GCAP WHERE KEY_1 like '003%' AND SUBSTR(KEY_1,4,16) = SUBSTR(PRI_ACCT_NO,1,16)";
	public static final String CREATE_DEPOSIT_TRNS_VIEW = "CREATE VIEW DEPOSIT_TRNS AS SELECT /*+ PARALLEL(INCT,64) */ LPAD( ACCT_NO || CHECKDIGIT.GENERATE (ACCT_NO), 17, ' ' ) AS ACCT_NO, TO_CHAR ( to_date ('31-dec-1899', 'dd-mon-yyyy') + BASECONV.CONVDATA (VAR_AREA, 5, 4), 'DD/MM/YYYY' ) AS TRANDATE, JRNL_NO, CASE WHEN TRAN_TYPE = 01 AND BASECONV.CONVDATA (VAR_AREA, 33, 8, 3) < 0 THEN 'DR ' WHEN BASECONV.CONVDATA (VAR_AREA, 33, 8, 3) > 0 THEN 'CR' ELSE 'NONFIN' END AS TRNDRCR, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 17, 4) ELSE 0 END AS TRNCODE, CASE WHEN TRAN_TYPE IN (01, 80) THEN SUBSTR( LPAD( BASECONV.CONVDATA (VAR_AREA, 9, 8), 10, '0' ), 6, 5 ) ELSE '0' END AS TLRBRCH, BASECONV.CONVDATA (VAR_AREA, 70, 4) AS CHQNO, SUBSTR(c.ENQUIRY_DESC, 1, 20) AS ENQUIRY_DESC, CASE WHEN TRAN_TYPE = 20 THEN SUBSTR(VAR_AREA, 13, 40) ELSE ' ' END AS NARRATION, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 33, 8, 3) ELSE 0 END AS TRNAMT, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 41, 8, 3) ELSE 0 END AS BALANCE, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 61, 4) ELSE 0 END AS POST_TIME, b.branch_no, b.gl_class_code, b.acct_type, b.int_cat FROM INCT A JOIN invm b ON a.inst_no = '003' AND b.key_1 = a.inst_no || a.ACCT_NO LEFT OUTER JOIN ed1p c ON b.key_1 = a.inst_no || a.ACCT_NO AND c.TRAN_CODE = BASECONV.CONVDATA (a.VAR_AREA, 17, 4) AND TRAN_TYPE IN (01, 20, 80) ";
	public static final String CREATE_FD_PARAM_VIEW = "CREATE VIEW FD_PARAM AS SELECT a.type, a.int_cat, a.descript, SUBSTR(cr_id_det, 1, 4)cr_id_det1, SUBSTR(cr_id_Det, 5, 4)cr_id_det2, SUBSTR(cr_id_det, 9, 4)cr_id_det3, NULL AS val1, NULL AS val2, CASE b.key_pointer WHEN ' ' THEN RPAD(b.rate, 10, ' ') ELSE RPAD( b.rate + to_number ( (SELECT c.rate FROM basm c WHERE c.base_id || c.rate_id = b.key_pointer || SUBSTR(a.cr_id_det, 5, 4) AND ( c.base_id || c.rate_id, c.BASM_date || c.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(basm.BASM_date || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)) ), 10, ' ' ) END AS rate, DECODE(a.status, 0, 'ACTIVE', 'INACTIVE') AS STATUS FROM depp a, BASM b WHERE (a.acct_desc = 'T') AND SUBSTR(a.cr_id_det, 1, 8) = b.base_id || b.rate_id AND SUBSTR(a.cr_id_det, 9, 4) = ' ' AND ( SUBSTR(a.cr_id_det, 1, 8), b.BASM_DATE || b.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id) union SELECT p.type, p.int_cat, p.descript, SUBSTR(cr_id_det, 1, 4)cr_id_det1, SUBSTR(cr_id_Det, 5, 4)cr_id_det2, SUBSTR(cr_id_det, 9, 4)cr_id_det3, NULL val1, NULL val2, to_char (0) AS char1, DECODE(p.status, 0, 'ACTIVE', 'INACTIVE') AS STATUS FROM depp p WHERE (p.acct_desc = 'T') AND ( ( SUBSTR(p.cr_id_det, 1, 8) = ' ' ) OR (SUBSTR(p.cr_id_det, 1, 8)) NOT IN (SELECT DISTINCT base_id || rate_id FROM basm) ) union SELECT d.type, d.int_cat, d.descript, SUBSTR(cr_id_det, 1, 4)cr_id_det1, SUBSTR(cr_id_Det, 5, 4)cr_id_det2, SUBSTR(cr_id_det, 9, 4)cr_id_det3, 'UPTO' AS UPTO, f.maximum_value AS MAXIMUM_VALUE, CASE e.key_pointer WHEN ' ' THEN RPAD( DECODE( f.RATE_INCR_DECR, NULL, e.rate, e.RATE + RATE_INCR_DECR ), 10, ' ' ) ELSE RPAD( DECODE( f.RATE_INCR_DECR, NULL, e.rate + to_number ( (SELECT h.rate FROM basm h WHERE h.base_id || h.rate_id = e.key_pointer || SUBSTR(d.cr_id_det, 5, 4) AND ( h.base_id || h.rate_id, h.BASM_DATE || h.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)) ), e.rate + to_number ( (SELECT h.rate FROM basm h WHERE h.base_id || h.rate_id = e.key_pointer || SUBSTR(d.cr_id_det, 5, 4) AND ( h.base_id || h.rate_id, h.BASM_DATE || h.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)) + RATE_INCR_DECR ) ), 10, ' ' ) END AS RATE, DECODE(d.status, 0, 'ACTIVE', 'INACTIVE') AS STATUS FROM depp d, BASM e, tier f WHERE (d.acct_desc = 'T') AND SUBSTR(d.cr_id_det, 1, 8) = e.base_id || e.rate_id AND f.group_id (+) = SUBSTR(d.cr_id_det, 9) AND ( d.cr_id_det, e.BASM_DATE || e.basm_time || f.tier_date || f.tier_time ) IN (SELECT DISTINCT basm.base_id || basm.rate_id || tier.group_id, MIN( basm.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) FROM BASM, tier WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) AND tier.tier_date >= 999999999- (SELECT to_char ((SYSDATE), 'J') - 2415020 FROM DUAL) GROUP BY basm.base_id || basm.rate_id || tier.group_id) ORDER BY 1, 2, 8";
	public static final String CREATE_SBCA_PARAM_VIEW = "CREATE VIEW SBCA_PARAM AS SELECT d.type, d.int_Cat, d.descript, 'UPTO' AS UPTO, f.maximum_value AS TIER, CASE e.key_pointer WHEN ' ' THEN RPAD( DECODE( f.RATE_INCR_DECR, NULL, e.rate, e.RATE + RATE_INCR_DECR ), 10, ' ' ) ELSE RPAD( DECODE( f.RATE_INCR_DECR, NULL, e.rate + (SELECT h.rate FROM basm h WHERE h.base_id || h.rate_id = e.key_pointer || SUBSTR(d.cr_id_det, 5, 4) AND ( h.base_id || h.rate_id, h.BASM_DATE || h.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)), e.rate + (SELECT h.rate FROM basm h WHERE h.base_id || h.rate_id = e.key_pointer || SUBSTR(d.cr_id_det, 5, 4) AND ( h.base_id || h.rate_id, h.BASM_DATE || h.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)) + RATE_INCR_DECR ), 10, ' ' ) END AS RATE, min_bal, min_open_bal, DORMANCY_PERIOD, INOPRTV_PERIOD, UNCLAIMED_PERIOD, DECODE( Divi_flag, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Y', 'Yearly' ) AS Divi_flag, DECODE( eop_date, 0, ' ', to_date ('31-12-1899', 'DD-MM-YY') + EOP_DATE ) AS EOP_DATE, to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT AS CLOSE_DT, DECODE(d.status, 0, 'ACTIVE', 'INACTIVE') AS STATUS FROM depp d, BASM e, tier f WHERE (d.type LIKE '1%' OR d.type LIKE '5%') AND SUBSTR(d.cr_id_det, 1, 8) = e.base_id || e.rate_id AND f.group_id (+) = SUBSTR(d.cr_id_det, 9) AND ( d.cr_id_det, e.BASM_DATE || e.basm_time || f.tier_date || f.tier_time ) IN (SELECT DISTINCT basm.base_id || basm.rate_id || tier.group_id, MIN( basm.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) FROM BASM, tier WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) AND tier.tier_date >= 999999999- (SELECT to_char ((SYSDATE), 'J') - 2415020 FROM DUAL) GROUP BY basm.base_id || basm.rate_id || tier.group_id) UNION SELECT a.type, a.int_Cat, a.descript, NULL, NULL, CASE b.key_pointer WHEN ' ' THEN RPAD(b.rate, 10, ' ') ELSE RPAD( b.rate + (SELECT c.rate FROM basm c WHERE c.base_id || c.rate_id = b.key_pointer || SUBSTR(a.cr_id_det, 5, 4) AND ( c.base_id || c.rate_id, c.BASM_DATE || c.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id)), 10, ' ' ) END, min_bal, min_open_bal, DORMANCY_PERIOD, INOPRTV_PERIOD, UNCLAIMED_PERIOD, DECODE( Divi_flag, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Y', 'Yearly' ), DECODE( eop_date, 0, ' ', to_date ('31-12-1899', 'DD-MM-YY') + EOP_DATE ), to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT, DECODE(a.status, 0, 'ACTIVE', 'INACTIVE') FROM depp a, BASM b WHERE (a.type LIKE '1%' OR a.type LIKE '5%') AND SUBSTR(a.cr_id_det, 1, 8) = b.base_id || b.rate_id AND SUBSTR(a.cr_id_det, 9, 4) = ' ' AND ( SUBSTR(a.cr_id_det, 1, 8), b.BASM_DATE || b.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm.basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id) UNION SELECT p.type, p.int_Cat, p.descript, NULL, NULL, to_char (0), min_bal, min_open_bal, DORMANCY_PERIOD, INOPRTV_PERIOD, UNCLAIMED_PERIOD, DECODE( Divi_flag, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Y', 'Yearly' ), DECODE( eop_date, 0, ' ', to_date ('31-12-1899', 'DD-MM-YY') + EOP_DATE ), to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT, DECODE(p.status, 0, 'ACTIVE', 'INACTIVE') FROM depp p WHERE (p.type LIKE '1%' OR p.type LIKE '5%') AND ( ( SUBSTR(p.cr_id_det, 1, 8) = ' ' ) OR (SUBSTR(p.cr_id_det, 1, 8)) NOT IN (SELECT DISTINCT base_id || rate_id FROM basm) ) ORDER BY 1, 2, 5";
	public static final String CREATE_CCOD_PARAM_VIEW = "CREATE VIEW CCOD_PARAM AS SELECT depp.TYPE, depp.INT_CAT, depp.descript, DECODE( RATE_INCR_DECR, NULL, basm.rate, BASM.RATE + RATE_INCR_DECR ) AS rate, MAXIMUM_VALUE, DECODE( DR_INT_FREQ, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Yearly' ) DR_INT_FREQ, DECODE( DR_COMP_FREQ, ' ', 'Simple', '1M ', 'Monthly', '3M ', 'Quarterly', '6M ', 'Half Yearly', 'YM ', 'Yearly' ) DR_COMP_FREQ, to_date ('31-12-1899', 'DD-MM-YY') + DR_EOP_DATE AS DR_EOP_DATE, to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT AS CLOSE_DT, depp.OD_INDICATOR, depp.OD_LIMIT_MAX, depp.DRAWING_POWER_APPL, depp.OD_MULTI_LIM_ALLOW, DECODE( depp.status, 0, 'ACTIVE', 'INACTIVE' ) AS STATUS FROM depp, tier, BASM WHERE SUBSTR(depp.PUR_2_ID_DET, 1, 8) = baSM.BASE_ID || BASM.RATE_ID AND tier.group_id (+) = SUBSTR(depp.PUR_2_ID_DET, 9) AND ( DEPP.PUR_2_ID_DET, BASM.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) IN (SELECT DISTINCT basm.base_id || basm.rate_id || tier.group_id, MIN( basm.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) FROM BASM, tier WHERE basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) AND tier_Date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY basm.base_id || basm.rate_id || tier.group_id) UNION SELECT depp.TYPE, depp.INT_CAT, depp.descript, basm.rate, NULL, DECODE( DR_INT_FREQ, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Yearly' ) DR_INT_FREQ, DECODE( DR_COMP_FREQ, ' ', 'Simple', '1M ', 'Monthly', '3M ', 'Quarterly', '6M ', 'Half Yearly', 'YM ', 'Yearly' ) DR_COMP_FREQ, to_date ('31-12-1899', 'DD-MM-YY') + DR_EOP_DATE AS DR_EOP_DATE, to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT AS CLOSE_DT, depp.OD_INDICATOR, depp.OD_LIMIT_MAX, depp.DRAWING_POWER_APPL, depp.OD_MULTI_LIM_ALLOW, DECODE( depp.status, 0, 'ACTIVE', 'INACTIVE' ) AS STATUS FROM depp, BASM WHERE depp.PUR_2_ID_DET = baSM.BASE_ID || BASM.RATE_ID || ' ' AND ( SUBSTR(DEPP.PUR_2_ID_DET, 1, 8), BASM.BASM_DATE || basm.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id) UNION SELECT depp.TYPE, depp.INT_CAT, depp.descript, 0, NULL, DECODE( DR_INT_FREQ, '0', 'No Interest', '1', 'Monthly', '3', 'Quarterly', '6', 'Half Yearly', 'Yearly' ) DR_INT_FREQ, DECODE( DR_COMP_FREQ, ' ', 'Simple', '1M ', 'Monthly', '3M ', 'Quarterly', '6M ', 'Half Yearly', 'YM ', 'Yearly' ) DR_COMP_FREQ, to_date ('31-12-1899', 'DD-MM-YY') + DR_EOP_DATE AS DR_EOP_DATE, to_date ('31-12-1899', 'DD-MM-YY') + CLOSE_DT AS CLOSE_DT, depp.OD_INDICATOR, depp.OD_LIMIT_MAX, depp.DRAWING_POWER_APPL, depp.OD_MULTI_LIM_ALLOW, DECODE( depp.status, 0, 'ACTIVE', 'INACTIVE' ) AS STATUS FROM depp WHERE pur_2_id_Det LIKE ' ' AND TYPE LIKE '6%'";
	public static final String CREATE_LOAN_PARAM_VIEW = "CREATE VIEW LOAN_PARAM AS SELECT lonp.ACCT_TYPE, lonp.INT_CAT, lonp.cat_type_name, DECODE( RATE_INCR_DECR, NULL, basm.rate, BASM.RATE + RATE_INCR_DECR ) AS rate, MAXIMUM_VALUE, SUBSTR(min_term, 1, 4) AS min_term, SUBSTR(max_term, 1, 4) AS max_term, min_loan, max_loan, fine_rate, DECODE( capn_freq, '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS capn_freq, DECODE( comp_freq, '00', 'Simple', '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS comp_freq, CASE WHEN end_date < (to_char (SYSDATE, 'J') - 2415020) THEN 'INACTIVE' ELSE 'ACTIVE' END AS STATUS FROM lonp, tier, BASM WHERE lonp.BASM_BASE_ID = BASM.BASE_ID AND lonp.BASM_RATE_ID = BASM.RATE_ID AND tier.group_id (+) = lonp.tier_group_id AND ( LONP.BASM_BASE_ID || LONP.BASM_RATE_ID || lonp.tier_group_id, BASM.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) IN (SELECT DISTINCT basm.base_id || basm.rate_id || tier.group_id, MIN( basm.BASM_DATE || basm.basm_time || tier.tier_date || tier.tier_time ) FROM BASM, tier WHERE basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) AND tier_Date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY basm.base_id || basm.rate_id || tier.group_id) UNION SELECT lonp.ACCT_TYPE, lonp.INT_CAT, lonp.cat_type_name AS PROD_DESC, basm.rate, NULL, SUBSTR(min_term, 1, 4) AS min_term, SUBSTR(max_term, 1, 4) AS max_term, min_loan, max_loan, fine_rate, DECODE( capn_freq, '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS capn_freq, DECODE( comp_freq, '00', 'Simple', '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS comp_freq, CASE WHEN end_date < (to_char (SYSDATE, 'J') - 2415020) THEN 'INACTIVE' ELSE 'ACTIVE' END AS STATUS FROM lonp, BASM WHERE lonp.BASM_BASE_ID = BASM.BASE_ID AND lonp.BASM_RATE_ID = BASM.RATE_ID AND lonp.tier_group_id = ' ' AND ( LONP.BASM_BASE_ID || LONP.BASM_RATE_ID, BASM.BASM_DATE || basm.basm_time ) IN (SELECT DISTINCT base_id || rate_id, MIN(BASM_DATE || basm.basm_time) FROM BASM WHERE basm_date >= 999999999- (SELECT to_number (to_char ((SYSDATE), 'J') - 2415020) FROM DUAL) GROUP BY base_id || rate_id) UNION SELECT lonp.ACCT_TYPE, lonp.INT_CAT, lonp.cat_type_name AS PROD_DESC, 0, NULL, SUBSTR(min_term, 1, 4) AS min_term, SUBSTR(max_term, 1, 4) AS max_term, min_loan, max_loan, fine_rate, DECODE( capn_freq, '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS capn_freq, DECODE( comp_freq, '00', 'Simple', '01', 'Monthly', '03', 'Quarterly', '06', 'Half Yearly', '12', 'Yearly' ) AS comp_freq, CASE WHEN end_date < (to_char (SYSDATE, 'J') - 2415020) THEN 'INACTIVE' ELSE 'ACTIVE' END AS STATUS FROM lonp WHERE lonp.basm_base_id = ' '";
	public static final String CREATE_RTGS_TRANS_VIEW = "CREATE VIEW RTGS_TRANS AS SELECT R.TRAN_BRANCH, nvl(I.BRANCH_NO,'00000') as ACT_BRANCH_NO, TRAN_DATE, R.UTR, R.REVRS_UTR, R.IN_OUT, DECODE(R.IN_OUT,'O','OUTWARD','I','INWARD','UNKNOWN') AS IN_OUT_DESC, R.SUB_MSG_TYPE, R.CORE_NONCORE, R.STATUS, R.AMOUNT, R.IFSC_SENDER, R.IFSC_RECVR, R.RELATED_REF_NO, R.ACCOUNT_NO, R.BENEF_ACCT_NO, substr(R.ORDER_CUSTOMER,1,70) AS ORDER_CUSTOMER, substr(R.BENEF_CUSTOMER,35,35) AS BENEF_CUSTOMER from INVM I , RTGS R where R.INST_NO = '003' and R.INST_NO || substr(R.ACCOUNT_NO,1,16)= i.key_1";
	public static final String CREATE_IMPS_TRANS_VIEW = "CREATE VIEW IMPS_TRANS AS SELECT TRAN_BRANCH , TRAN_DATE, TRAN_TIME , TERMINAL_DATE, TERMINAL_TIME , TRAN_CODE , CASE WHEN CHANNEL <> 'BRC' THEN RR_NO ELSE NULL END AS RR_NO , IN_OUT , CHANNEL , SUB_MSG_TYPE , IFSC_SENDER, IFSC_RECVR, ACCOUNT_NO, BENEF_ACCT_NO, JRNL_NO_1, JRNL_NO_2, JRNL_NO_3, AMOUNT, COMMISSION, READ_STATUS, STATUS, DECODE( STATUS, 'UNPR', 'UNPROCESSED', 'PROS', 'PROCESSED', 'SUSP', 'SUSPENDED', 'WAIT', 'REMITTED', 'RVRS', 'REVERSED', 'FAIL', 'FAILED', 'RETU', 'RETURNED UNPAID', 'UNKN', 'UNKNOWN', 'RESC', 'RESCHEDULED', 'NO STATUS FOUND' ) AS STATUS_DESC, CASE WHEN CHANNEL = 'BRC' THEN RR_NO ELSE ' ' END AS TXN_ID FROM IMPA";
	public static final String CREATE_LOAN_TRANS_VIEW = "CREATE VIEW LOAN_TRANS AS SELECT /*+ PARALLEL(BOCT,64) */ inst_no, LPAD( ACCT_NO || CHECKDIGIT.GENERATE (ACCT_NO), 17, ' ' ) AS ACCT_NO, TO_CHAR ( to_date ('31-dec-1899', 'dd-mon-yyyy') + TRAN_DATE, 'DD/MM/YYYY' ) AS TRANDATE, JRNL_NO, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 17, 4) ELSE 0 END AS TRNCODE, (SELECT SUBSTR(TEXT, 1, 20) FROM txop WHERE key_1 = '003' || LPAD( BASECONV.CONVDATA (VAR_AREA, 17, 4), 6, '0' ) || 'TCSH01') AS TRNS_DESC, CASE WHEN TRAN_TYPE = 20 THEN SUBSTR(VAR_AREA, 13, 40) ELSE ' ' END AS NARRATION, CASE WHEN TRAN_TYPE = 01 AND BASECONV.CONVDATA (VAR_AREA, 33, 8, 3) < 0 THEN 'DR ' WHEN TRAN_TYPE = 20 THEN ' ' ELSE 'CR' END AS TRNMODE, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 33, 8, 3) ELSE 0 END AS TRNAMT, CASE WHEN TRAN_TYPE IN (01, 80) THEN BASECONV.CONVDATA (VAR_AREA, 41, 8, 3) ELSE 0 END AS BALANCE, SUBSTR( LPAD( BASECONV.CONVDATA (VAR_AREA, 9, 8), 10, '0' ), 6, 5 ) AS TLRBRCH FROM BOCT A WHERE a.inst_no = '003' AND TRAN_TYPE IN (01, 20, 80) AND TRAN_DATE > TO_CHAR ( TO_DATE ( ADD_MONTHS (SYSDATE, - 3), 'DD-MON-YY' ), 'J' ) - 2415020";
	public static final String CREATE_GLINF_VIEW = "CREATE VIEW GLINF AS SELECT KEY_1 , SOC , BRCH , FCY_CODE , GL_CLASS_CODE , DESCRIPTION , POSTING_IND , tO_DATE(TO_CHAR(TO_DATE('31-DEC-1899','DD-MON-YYYY') + TRANS_DATE,'DD/MM/YYYY'), 'DD/MM/YYYY') TRANS_DATE , LCY_AMT , FCY_AMT , REVERSAL_CODE , GLIF_REFERENCES , SOURCE_APPLN , PS_JOURNAL_ID , PS_JOURNAL_NBR from GLIF WHERE substr(key_1,5,5) > TO_CHAR(TO_DATE(ADD_MONTHS(SYSDATE,-3),'DD-MON-YY'),'J')-2415020";

	public static final String CREATE_UIDL_MASTER_VIEW = "CREATE VIEW UIDL_MASTER AS SELECT BRANCH_NO, ACCT_TYPE, INT_CAT, SUBSTR(a.KEY_1||CHECKDIGIT.GENERATE(SUBSTR(A.KEY_1,4,16)),4,17) AS ACCT_NO, CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO) AS CUST_NO, CURR_BAL, CURR_STATUS , UID_ID, UID_NO, tO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + LINK_DATE, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) LINK_DATE, LINK_STAT, tO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + STAT_CHG_DT, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) STAT_CHG_DT, MAKER_ID, CHECKER_ID, OTH_DETAILS, AMEND_FLAG, IIN_NO FROM invm a, uidl b where a.key_1='003'||b.ACCOUNT_NO UNION ALL SELECT BR_NO, ACT_TYPE AS ACCT_TYPE, CAT AS INT_CAT, SUBSTR(a.KEY_1||CHECKDIGIT.GENERATE(SUBSTR(A.KEY_1,4,16)),4,17) AS ACCT_NO, CUSTOMER_NO||CHECKDIGIT.GENERATE(CUSTOMER_NO) AS CUST_NO, LOAN_BAL AS CURR_BAL, STAT AS CURR_STATUS , UID_ID, UID_NO, tO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + LINK_DATE, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) LINK_DATE, LINK_STAT, tO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + STAT_CHG_DT, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) STAT_CHG_DT, MAKER_ID, CHECKER_ID, OTH_DETAILS, AMEND_FLAG, IIN_NO FROM BORM a, uidl b where a.key_1= '003'||b.ACCOUNT_NO";
	public static final String CREATE_TAX_MASTER_VIEW = "CREATE VIEW TAX_MASTER AS SELECT /*+ INDEX(INVM,INVMPK) INDEX(TDSm,TDSMPK) INDEX(TDSv,TDSvPK) */ SUBSTR( i.KEY_1 || CHECKDIGIT.GENERATE (SUBSTR(i.KEY_1, 4, 16)), 4, 17 ) AS ACCT_NO, i.customer_no || CHECKDIGIT.GENERATE (customer_no) AS CUST_NO, i.BRANCH_NO, acct_type, int_cat, curr_status, curr_bal, m.F15H_SUBMIT F15_H, TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + F15H_SUB_DT, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) AS F15H_SUB_DT, v.INT_PAID_YTD acct_INT_PAID_YTD, v.TAX_PROJ_YTD acct_TAX_PROJ_YTD, v.TAX_DEDUCT_YTD acct_TAX_DEDUCT_YTD, m.INT_PROJ_FIN_YR cust_INT_PROJ_FIN_YR, m.INT_PAID_YTD cust_INT_PAID_YTD, m.TAX_PROJ_FIN_YR cust_TAX_PROJ_FIN_YR, m.TAX_DEDUCT_YTD cust_TAX_DEDUCT_YTD, m.TDS_EXEMPTION, m.tax_year FROM invm i, tdsv v, tdsm m WHERE v.SOC_NO || v.ACCT_NO = key_1 AND m.CUST_NO = i.customer_no";
	public static final String CREATE_CUID_MASTER_VIEW = "CREATE VIEW CUID_MASTER AS SELECT A.CUST_NO||CHECKDIGIT.GENERATE(A.CUST_NO) AS CUST_NO, A.ID_TYPE, B.ID_DESCRIPTION , A.ID_NUMBER, A.ID_EXPIRY_DATE, A.ID_ISSUE_AT, A.ID_REMARK , A.ID_MAIN FROM CUID A, IDTP B WHERE A.INST_NO = B.INST_NO AND A.ID_TYPE = B.ID_TYPE";
	public static final String CREATE_DDFT_MASTER_VIEW = "CREATE VIEW DDFT_MASTER AS SELECT TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + ISSUE_DATE, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) AS ISSUE_DATE, ISSUE_BRCH AS ISSUE_BRANCH, DRAFT_NUM AS INSTRUMENT_NO, BR_NAME AS ISSUE_BR_NAME, INT_ACCNO AS GL_ACCOUNT_NO, DRAFT_PREFIX, INSTRU_ACCNO AS ACCOUNT_NO, DECODE( DRAFT_STAT, '0', 'TO_BE_ISSUED', '1', 'ISSUED', '2', 'PAID', '3', 'CANCELLED' ) AS STATUS, DRAFT_AMOUNT AS AMOUNT, PAY_BANK AS PAYEE_BANK, PAY_BRCH AS PAYEE_BRANCH, L.BRCH_DESC AS PAYEE_BR_NAME, NAME1_BFIC AS BENEFICIARY_NAME, NAME1_APP AS APPLICANTS_NAME FROM DDFT D, BRHM B, BRLS L WHERE ISSUE_BRCH = SUBSTR(KEY_1, 15, 5) AND PAY_BANK = BANK_CODE AND PAY_BRCH = BRCH_CODE";
	public static final String CREATE_MCAD_MASTER_VIEW = "CREATE VIEW MCAD_MASTER AS SELECT TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + JRNL_DATE, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) AS JRNL_DATE, JRNL_NO , JRNL_TIME, BRANCH_NO , TRAN_CODE , SYSTEM , CUST_ACCT_NO|| CHECKDIGIT.GENERATE (CUST_ACCT_NO) AS CUST_ACCT_NO, TRAN_AMT , MAKER_ID , SUP_ID , SUP_DT_TIME, CHECKER1_ID , CHECKER1_DT_TIME, CHECKER2_ID , CHECKER2_DT_TIME FROM MCAD WHERE SOC_NO ='003'";
	public static final String CREATE_SI_MASTER_VIEW = "CREATE VIEW SI_MASTER AS SELECT BRCH, LPAD( LTRIM(from_acct_no, 0) || checkdigit.generate (from_acct_no), 11, ' ' ) FR_ACCT_NO, LPAD( LTRIM(to_acct_no, 0) || checkdigit.generate (to_acct_no), 11, ' ' ) TO_ACCT_NO , TO_SYS, AMOUNT, DECODE( CODE, 'D', 'DAILY', 'M', 'MONTHLY', 'E', 'END OF MON' ) as FREQ, TO_DATE ( TO_CHAR ( TO_DATE ('31-DEC-1899', 'DD-MON-YYYY') + NEXT_PAY_DATE, 'DD/MM/YYYY' ), 'DD/MM/YYYY' ) AS NEXT_PAY_DATE, TELLER, SEQ_NO FROM SORD";
	public static final String CREATE_COLM_MASTER_VIEW = "CREATE VIEW COLM_MASTER AS SELECT I.BRANCH_NO,I.ACCT_TYPE,I.INT_CAT,I.CURR_BAL,I.CURR_STATUS, LPAD(SUBSTR(R1.KEY_2, 4,16)||CHECKDIGIT.GENERATE(SUBSTR(R1.KEY_2, 4, 16)),17,0) AS ACCT, SUBSTR(R1.KEY_2, 20, 3) AS FD_SYS, LPAD(SUBSTR(R1.KEY_2,23,16)||CHECKDIGIT.GENERATE(SUBSTR(R1.KEY_2, 23,16)),17,0) AS COLL_ACCT, SUBSTR(R1.KEY_2, 39,42) AS COLL, D1.TYPE, D1.SUB_TYPE, c1.DESCRIPTION, D1.CHARGE_TYPE, DECODE(D1.CHARGE_TYPE,'01','EQMOR','02','ENMOR','03','PLEDG','04','HYPOE','05','LIEN','06','ASSIG','OTHERS') AS CHARGE_DESC, TO_CHAR(to_date('31-dec-1899','dd-mon-yyyy') + D1.START_DATE,'DD/MM/YYYY') AS START_DATE, D1.STOCK_SEQ, R1.SECURITY_AMOUNT FROM COLM D1, RACD R1 , colt C1 , INVM I WHERE D1.KEY_1 = SUBSTR(R1.KEY_1, 1, 19) and c1.inst_no='003' and c1.COL_TYPE||c1.SUB_TYPE = d1.TYPE||d1.SUB_TYPE and i.key_1 = SUBSTR(R1.KEY_2, 1,19) AND I.CURR_STATUS <>'07' UNION ALL SELECT I.BR_NO,I.ACT_TYPE,I.CAT,I.LOAN_BAL,I.STAT, LPAD(SUBSTR(R1.KEY_2, 4,16)||CHECKDIGIT.GENERATE(SUBSTR(R1.KEY_2, 4, 16)),17,0) AS ACCT, SUBSTR(R1.KEY_2, 20, 3) AS FD_SYS, LPAD(SUBSTR(R1.KEY_2,23,16)||CHECKDIGIT.GENERATE(SUBSTR(R1.KEY_2, 23,16)),17,0) AS COLL_ACCT, SUBSTR(R1.KEY_2, 39,42) AS COLL, D1.TYPE, D1.SUB_TYPE, c1.DESCRIPTION, D1.CHARGE_TYPE, DECODE(D1.CHARGE_TYPE,'01','EQMOR','02','ENMOR','03','PLEDG','04','HYPOE','05','LIEN','06','ASSIG','OTHERS') AS CHARGE_DESC, TO_CHAR(to_date('31-dec-1899','dd-mon-yyyy') + D1.START_DATE,'DD/MM/YYYY') AS START_DATE, D1.STOCK_SEQ, R1.SECURITY_AMOUNT FROM COLM D1, RACD R1 , colt C1 , BORM I WHERE D1.KEY_1 = SUBSTR(R1.KEY_1, 1, 19) and c1.inst_no='003' and c1.COL_TYPE||c1.SUB_TYPE = d1.TYPE||d1.SUB_TYPE and i.key_1 = SUBSTR(R1.KEY_2, 1,19) AND STATUS <>'40'";
	public static final String COMPLETED="COMPLETED";
	public static final String IN_PROCESS="INPROCESS";
	public static final String IN_QUEUE="IN_QUEUE";
	public Session getCurrentSession(String bank, Banks db) {
		Session session = null;
		session = HibernateUtil.getSessionFactory(db).openSession();
		logger.info("Session Factory :: " + bank + " :: " + session);
		return session;

	}

	public Session getCurrentSession(String bank) {
		Session session = null;
		Banks db = adminReportService.populateBankDbDetail(bank);
		session = HibernateUtil.getSessionFactory(db).openSession();
		logger.info("Session Factory :: " + bank + " :: " + session);
		return session;

	}

}
